<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å¯¶å¯¶èªçŸ¥æŒ‘æˆ°å„ªåŒ–ç‰ˆ</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root { --bg: #FFF9E3; --primary: #FF6B6B; --success: #4CAF50; }
        body { margin: 0; background: var(--bg); font-family: sans-serif; display: flex; flex-direction: column; align-items: center; -webkit-user-select: none; padding-top: 20px; }
        .quiz-status { font-size: 26px; font-weight: bold; color: var(--primary); margin: 15px 0; min-height: 40px; }
        .mode-switch { margin-bottom: 15px; }
        .mode-btn { padding: 8px 20px; border-radius: 20px; border: 2px solid var(--primary); background: white; color: var(--primary); font-weight: bold; margin: 0 5px; }
        .mode-btn.active { background: var(--primary); color: white; }
        .nav { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .nav-btn { padding: 10px 15px; border: none; border-radius: 20px; background: white; box-shadow: 0 4px 0 #FFD93D; font-weight: bold; }
        .nav-btn.active { background: #FFD93D; }
        .grid-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; width: 90%; max-width: 400px; padding-bottom: 40px; }
        .card { background: white; border-radius: 25px; box-shadow: 0 6px 0 #FFD93D; display: flex; flex-direction: column; align-items: center; padding: 20px; transition: 0.1s; }
        .card:active { transform: scale(0.9); }
        .emoji { font-size: 65px; }
        .label { font-size: 20px; font-weight: bold; margin-top: 5px; }
        @keyframes success-pop { 0% {transform: scale(1);} 50% {transform: scale(1.15);} 100% {transform: scale(1);} }
        .correct { border: 5px solid var(--success); animation: success-pop 0.5s; }
    </style>
</head>
<body>

    <div id="quiz-msg" class="quiz-status">æº–å‚™å¥½äº†å—ï¼Ÿ</div>

    <div class="mode-switch">
        <button id="btn-learn" class="mode-btn active" onclick="setMode('learn')">å­¸ç¿’æ¨¡å¼</button>
        <button id="btn-quiz" class="mode-btn" onclick="setMode('quiz')">æŒ‘æˆ°æ¨¡å¼</button>
    </div>

    <div class="nav">
        <button class="nav-btn active" onclick="changeCat('fruits', this)">ğŸ æ°´æœ</button>
        <button class="nav-btn" onclick="changeCat('animals', this)">ğŸ¶ å‹•ç‰©</button>
        <button class="nav-btn" onclick="changeCat('vehicles', this)">ğŸš— äº¤é€š</button>
    </div>

    <div id="grid" class="grid-container"></div>

    <script>
        const data = {
            fruits: [{n:'è˜‹æœ', i:'ğŸ'}, {n:'é¦™è•‰', i:'ğŸŒ'}, {n:'è¥¿ç“œ', i:'ğŸ‰'}, {n:'è‘¡è„', i:'ğŸ‡'}, {n:'è‰è“', i:'ğŸ“'}, {n:'æ©˜å­', i:'ğŸŠ'}],
            animals: [{n:'å°ç‹—', i:'ğŸ¶'}, {n:'å°è²“', i:'ğŸ±'}, {n:'å¤§è±¡', i:'ğŸ˜'}, {n:'å…”å­', i:'ğŸ°'}, {n:'ç…å­', i:'ğŸ¦'}, {n:'é•·é ¸é¹¿', i:'ğŸ¦’'}],
            vehicles: [{n:'æ±½è»Š', i:'ğŸš—'}, {n:'é£›æ©Ÿ', i:'âœˆï¸'}, {n:'è­¦è»Š', i:'ğŸš“'}, {n:'è…³è¸è»Š', i:'ğŸš²'}, {n:'ç«è»Š', i:'ğŸš‚'}, {n:'èˆ¹', i:'ğŸš¢'}]
        };

        let currentMode = 'learn';
        let currentCat = 'fruits';
        let targetItem = null;
        let lastTarget = null;

        function setMode(mode) {
            currentMode = mode;
            document.getElementById('btn-learn').classList.toggle('active', mode === 'learn');
            document.getElementById('btn-quiz').classList.toggle('active', mode === 'quiz');
            if (mode === 'quiz') {
                startNewQuestion();
            } else {
                document.getElementById('quiz-msg').innerText = "é»ä¸€é»ï¼Œå­¸èªªè©±";
            }
        }

        function changeCat(cat, btn) {
            currentCat = cat;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            render();
            if (currentMode === 'quiz') startNewQuestion();
        }

        function speak(txt) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(txt);
            u.lang = 'zh-TW';
            u.rate = 0.6; // æ…¢é€Ÿ
            u.pitch = 1.1; 
            window.speechSynthesis.speak(u);
        }

        function startNewQuestion() {
            const items = data[currentCat];
            let nextTarget;
            do {
                nextTarget = items[Math.floor(Math.random() * items.length)];
            } while (nextTarget === lastTarget && items.length > 1);
            
            targetItem = nextTarget;
            lastTarget = targetItem;
            document.getElementById('quiz-msg').innerText = `è«‹æ‰¾åˆ°ã€Œ${targetItem.n}ã€`;
            setTimeout(() => { speak(`è«‹æ‰¾åˆ°ï¼Œ${targetItem.n}`); }, 500);
        }

        function handleTap(item, el) {
            if (currentMode === 'learn') {
                speak(item.n);
            } else {
                if (item.n === targetItem.n) {
                    el.classList.add('correct');
                    speak("ç­”å°äº†ï¼ä½ çœŸæ£’");
                    setTimeout(() => {
                        el.classList.remove('correct');
                        startNewQuestion();
                    }, 2000); // çµ¦å¹¼å…’å¤šä¸€é»æ™‚é–“çœ‹æ­£ç¢ºç­”æ¡ˆ
                } else {
                    speak("ä¸å°å–”ï¼Œå†è©¦è©¦çœ‹");
                }
            }
        }

        function render() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            data[currentCat].forEach(item => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `<div class="emoji">${item.i}</div><div class="label">${item.n}</div>`;
                div.onclick = () => handleTap(item, div);
                grid.appendChild(div);
            });
        }

        window.onload = () => {
            render();
            document.getElementById('quiz-msg').innerText = "é»ä¸€é»ï¼Œå­¸èªªè©±";
        };
    </script>
</body>
</html>
